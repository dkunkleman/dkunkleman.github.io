<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Live Like Charlie ‚Äî Do one small good action.</title>
<meta name="description" content="Pick an action, post it, paste your link so it counts, and invite 3 friends." />

<style>
  :root{
    --ink:#eaf2ff; --bg:#0b1220; --panel:#0f1a33; --muted:#9fb3d1;
    --brand:#e11d48; --accent:#2563eb; --ok:#16a34a; --warn:#f59e0b;
    --ring: rgba(37, 99, 235, .45);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0;background:#0b1220;color:var(--ink);font-family:system-ui,Segoe UI,Roboto,Ubuntu,Helvetica,Arial,sans-serif;line-height:1.5}

  a{color:#9fc8ff;text-decoration:none;font-weight:700}
  .wrap{max-width:1200px;margin:0 auto;padding:0 16px}
  header{position:sticky;top:0;z-index:60;background:#0a0f1ce6;backdrop-filter:blur(6px);
          border-bottom:1px solid rgba(255,255,255,.2)}
  .nav{display:flex;align-items:center;justify-content:space-between;padding:10px 16px}
  .brand{font-weight:900;letter-spacing:.35px}
  .nav a.button{background:var(--brand);color:#fff;padding:8px 12px;border-radius:10px}

  /* Panel + cards */
  .panel{background:rgba(10,18,39,.58);border:1px solid rgba(255,255,255,.16);border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.45);padding:16px}

  /* Step cards */
  .step{display:grid;grid-template-columns:1fr;gap:10px;margin:12px 0}
  .step .stepcard{background:rgba(10,18,39,.6);border:1px solid rgba(255,255,255,.14);border-radius:14px;padding:14px}

  /* Composer modal (Step 2 popup) */
  .lc-modal{position:fixed;inset:0;display:none;z-index:1200}
  .lc-modal.open{display:block}
  .lc-backdrop{position:absolute;inset:0;background:rgba(0,0,0,.55)}
  .lc-sheet{position:absolute;inset:6% 8%;border-radius:14px;overflow:hidden;box-shadow:0 20px 60px rgba(0,0,0,.55)}
  .lc-sheet-bg{position:absolute;inset:0;background:#0f1a33 center/cover no-repeat;filter:brightness(.7);transform:scale(1.02)}
  .lc-sheet-inner{position:relative;inset:0;display:flex;flex-direction:column;height:100%;color:#fff}
  .lc-sheet-head{display:flex;justify-content:space-between;align-items:center;gap:10px;padding:10px 12px;background:rgba(10,15,28,.55);backdrop-filter:blur(6px);border-bottom:1px solid rgba(255,255,255,.15)}
  .lc-sheet-head .pill{margin-left:8px;padding:4px 8px;border:1px solid rgba(255,255,255,.25);border-radius:999px;font-size:.85rem;opacity:.9}
  .lc-sheet-body{padding:12px;overflow:auto}
  #composeText{width:100%;border-radius:12px;border:1px solid rgba(255,255,255,.25);background:rgba(0,0,0,.35);color:#fff;padding:10px 12px;min-height:132px}

  .btn{border:1px solid rgba(255,255,255,.18);background:rgba(255,255,255,.08);color:#fff;border-radius:10px;padding:10px 12px;cursor:pointer}
  .btn.primary{background:#2563eb;border-color:#2563eb}
  .btn.danger{background:#831843;border-color:#831843}
  .btn.success{background:#16a34a;border-color:#16a34a}

  /* Confetti */
  .confetti{position:fixed;inset:0;pointer-events:none;z-index:2000}
  .confetti i{position:absolute;width:8px;height:14px;opacity:.9;animation:fly 900ms ease-out forwards}
  @keyframes fly{
    to{transform:translate3d(var(--x),var(--y),0) rotate(var(--r));opacity:0}
  }

  /* Tiny toast */
  .toast{position:fixed;left:50%;bottom:24px;transform:translateX(-50%);background:#0f1a33;border:1px solid rgba(255,255,255,.18);
         color:#fff;padding:8px 12px;border-radius:10px;box-shadow:0 10px 30px rgba(0,0,0,.45);display:none;z-index:2100}
  .toast.show{display:block}
</style>
</head>

<body>
<header>
  <div class="nav wrap">
    <div class="brand">üá∫üá∏ <span style="color:#e11d48">Live</span>Like<span style="color:#2563eb">Charlie</span>.org</div>
    <nav style="display:flex;gap:12px;align-items:center">
      <a href="/index.html">Home</a>
      <a href="/actions.html">Actions</a>
      <a href="/about.html">About</a>
      <a href="/privacy.html">Privacy</a>
      <a href="/proofs.html">Proofs</a>
      <a href="/admin.html">Admin</a>
      <a href="/#impact" class="button">Impact</a>
    </nav>
  </div>
</header>

<main class="wrap" style="padding:16px 16px 80px">
  <!-- Step 1 -->
  <section class="panel step" id="step1">
    <div class="stepcard">
      <h3>STEP 1 ‚Äî CHOOSE AN ACTION</h3>
      <p class="muted">Pick from the Actions list. (Or land here from an action button.)</p>
      <select id="actionSelect" style="width:100%;margin-top:8px">
        <option value="">‚Äî choose an action ‚Äî</option>
        <option>Raise the Flag</option>
        <option>Show Gratitude</option>
        <option>Support the All-American Halftime Show</option>
        <option>Pick It Up</option>
        <option>Pray and Post</option>
        <option>Read the Bible</option>
        <option>Help at Home</option>
        <option>Be a Friend</option>
        <option>Donate to TPUSA or a Charity</option>
        <option>Volunteer 1 Hour</option>
        <option>Learn a New Skill</option>
        <option>Call or Visit Family</option>
        <option>Honor a Veteran or First Responder</option>
        <option>Share a Favorite Charlie Quote</option>
        <option>Join the Pete & Bobby Challenge</option>
        <option>Choose a Verse & Share</option>
        <option>Share a Forgiveness Story</option>
        <option>Meet Your Spouse with a Hug</option>
        <option>Intentional Family Time</option>
        <option>Do a Chore for Your Spouse</option>
        <option>Listen Without Interrupting</option>
        <option>Speak Truth with Humility</option>
        <option>Invite 3 People to Church</option>
        <option>Share Your Testimony</option>
        <option>Host a Film Night</option>
        <option>Hands-Free Driver</option>
        <option>Family Table Focus (3+ nights)</option>
        <option>Creator Proceeds Donor</option>
        <option>Phone Off at Church</option>
        <option>Host a Sale for Good</option>
        <option>Generations: 3 Together</option>
        <option>Register to Vote (or Verify)</option>
        <option>Pray for Your Leaders (Name Them)</option>
        <option>Bring a Teacher a Gift</option>
        <option>Join a TPUSA Chapter</option>
        <option>Veteran Visit (Honor & Listen)</option>
        <option>Purchase Charlie Gear</option>
        <option>Meal Train Start</option>
        <option>Coach or Mentor (Youth)</option>
        <option>Work for TPUSA</option>
        <option>Give a Bible to Someone</option>
        <option>Scripture Memory Share</option>
        <option>Pro-Life Serve Day</option>
        <option>Pro-Life: Celebrate Your Children</option>
        <option>Marriage Night</option>
        <option>Join TPUSA's The Charlie Challenge</option>
        <option>Join TPUSA's 1776 Society</option>
        <option>Apologetics Share</option>
        <option>Read Aloud with Kids</option>
        <option>Add Your Church</option>
        <option>Host a Like-Charlie Meetup</option>
        <option>Join TPUSA's Alumni</option>
        <option>Testimony Video (60‚Äì90s)</option>
        <option>Worship Playlist Share (Top 10)</option>
      </select>
      <div style="margin-top:8px">
        <button class="btn" id="openComposer">Open Compose Popup</button>
      </div>
    </div>
  </section>

  <!-- Step 2 (modal trigger lives here) -->
  <section class="panel step" id="step2">
    <div class="stepcard">
      <h3>STEP 2 ‚Äî COMPOSE YOUR POST</h3>
      <p class="muted">This opens a popup to help you post on X/Facebook/Instagram/TikTok.</p>
      <button class="btn primary" id="openComposer2">Compose now</button>
    </div>
  </section>

  <!-- Step 3 -->
  <section class="panel step" id="step3">
    <div class="stepcard">
      <h3>STEP 3 ‚Äî PASTE YOUR SOCIAL MEDIA POST LINK THEN CLICK COMPLETED CHALLENGE</h3>
      <input id="postLink" placeholder="https://x.com/you/status/... or https://www.facebook.com/..." />
      <div style="display:flex;gap:10px;margin-top:8px;flex-wrap:wrap">
        <input id="name" placeholder="(optional) Name" />
        <input id="email" placeholder="(optional) Email" />
      </div>
      <div style="margin-top:10px;display:flex;gap:10px;flex-wrap:wrap">
        <button class="btn success" id="completeBtn">Completed Challenge</button>
        <button class="btn" id="shareSiteBtn">Share this website</button>
      </div>
      <p class="muted" style="margin-top:8px">We‚Äôll count it and celebrate with confetti üéâ</p>
    </div>
  </section>
</main>

<!-- Compose Modal -->
<div class="lc-modal" id="composeModal" aria-hidden="true">
  <div class="lc-backdrop"></div>
  <div class="lc-sheet">
    <div class="lc-sheet-bg" id="composeBg"></div>
    <div class="lc-sheet-inner">
      <div class="lc-sheet-head">
        <strong>Step 2. Compose your post</strong>
        <span class="pill" id="selectedActionPill">No action selected</span>
        <button class="btn danger" id="closeComposer">Close</button>
      </div>
      <div class="lc-sheet-body">
        <p class="muted" style="margin:0 0 8px 0">Edit freely. We‚Äôll also copy this to your clipboard.</p>
        <textarea id="composeText">I just did ‚ÄúMeet Your Spouse with a Hug‚Äù with #LiveLikeCharlie ‚Äî your turn.
https://www.livelikecharliechallenge.org</textarea>
        <div style="display:flex;gap:10px;margin-top:10px;flex-wrap:wrap">
          <button class="btn" id="postX">Post on X</button>
          <button class="btn" id="postFb">Post on Facebook</button>
          <button class="btn" id="postIg">Open Instagram</button>
          <button class="btn" id="postTt">Open TikTok</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Confetti + toast containers -->
<div class="confetti" id="confetti"></div>
<div class="toast" id="toast">Copied site link to clipboard.</div>

<script>
  // Helpers
  const $ = (sel)=>document.querySelector(sel);

  function getParams(){
    const p=new URLSearchParams(location.search);
    return { action: p.get('action')||'', step: p.get('step')||'' };
  }

  function openComposer(prefill){
    if(prefill) $('#composeText').value = prefill;
    $('#composeModal').classList.add('open');
    document.body.style.overflow='hidden';
    // copy to clipboard
    try{ navigator.clipboard.writeText($('#composeText').value); }catch(e){}
  }
  function closeComposer(){
    $('#composeModal').classList.remove('open');
    document.body.style.overflow='';
  }

  // Preselect action from dropdown and pill
  function setAction(name){
    const sel = $('#actionSelect');
    if(!name) return;
    // try to match an existing option
    let found=false;
    [...sel.options].forEach(o=>{
      if(o.text.trim().toLowerCase()===name.trim().toLowerCase()){ sel.value=o.text; found=true; }
    });
    if(!found){ sel.value=''; }
    $('#selectedActionPill').textContent = found ? sel.value : name;
    // prefill composer text with selected action
    const text = `I just did ‚Äú${found?sel.value:name}‚Äù with #LiveLikeCharlie ‚Äî your turn.\nhttps://www.livelikecharliechallenge.org`;
    $('#composeText').value = text;
  }

  // Share the site (or copy as fallback)
  async function shareSite(){
    const url = 'https://www.livelikecharliechallenge.org';
    const title = 'Live Like Charlie';
    const text = 'Do one small good action. Post it. Invite 3 friends.';
    if(navigator.share){
      try{ await navigator.share({title,text,url}); }catch(e){}
    }else{
      try{ await navigator.clipboard.writeText(url); }catch(e){}
      const t=$('#toast'); t.classList.add('show'); setTimeout(()=>t.classList.remove('show'),1600);
    }
  }

  // Simple confetti burst
  function burstConfetti(){
    const box = $('#confetti');
    const N=120;
    for(let i=0;i<N;i++){
      const p=document.createElement('i');
      const x=(Math.random()*2-1)*500+'px';
      const y=(Math.random()*-1-0.6)*700+'px';
      const r=(Math.random()*720-360)+'deg';
      p.style.left=(innerWidth/2)+'px';
      p.style.top=(innerHeight-30)+'px';
      p.style.background = `hsl(${Math.random()*360},90%,60%)`;
      p.style.transform='translate3d(0,0,0)';
      p.style.setProperty('--x',x);
      p.style.setProperty('--y',y);
      p.style.setProperty('--r',r);
      box.appendChild(p);
      setTimeout(()=>p.remove(),950);
    }
  }

  // Wire buttons
  $('#openComposer').addEventListener('click', ()=>{
    const sel=$('#actionSelect').value;
    setAction(sel||'Picked an action');
    openComposer($('#composeText').value);
  });
  $('#openComposer2').addEventListener('click', ()=>{
    const sel=$('#actionSelect').value;
    setAction(sel||'Picked an action');
    openComposer($('#composeText').value);
  });
  $('#closeComposer').addEventListener('click', closeComposer);

  $('#postX').addEventListener('click', ()=>window.open('https://x.com/intent/tweet','_blank'));
  $('#postFb').addEventListener('click', ()=>window.open('https://www.facebook.com/','_blank'));
  $('#postIg').addEventListener('click', ()=>window.open('https://www.instagram.com/','_blank'));
  $('#postTt').addEventListener('click', ()=>window.open('https://www.tiktok.com/','_blank'));

  $('#shareSiteBtn').addEventListener('click', shareSite);

  $('#completeBtn').addEventListener('click', async ()=>{
    burstConfetti();
    // also nudge share
    setTimeout(shareSite, 300);
  });

  // On load: if coming from actions.html with ?action=...&step=2, open the popup
  (function(){
    const {action, step} = getParams();
    if(action){ setAction(decodeURIComponent(action)); }
    if(step==='2'){ openComposer($('#composeText').value); }
  })();
</script>
</body>
</html>
